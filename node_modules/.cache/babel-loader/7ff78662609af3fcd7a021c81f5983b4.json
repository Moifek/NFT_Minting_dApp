{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TestWallet = exports.loadTestWallet = exports.loadPassword = exports.loadMnemonic = exports.loadTestWallets = exports.syncTestWallets = exports.loadAndSyncTestWallets = void 0;\n\nconst axios_1 = __importDefault(require(\"axios\"));\n\nconst fs = __importStar(require(\"fs\"));\n\nconst path = __importStar(require(\"path\"));\n\nconst account_1 = require(\"../account\");\n\nconst address_1 = require(\"../address\");\n\nconst walletcore_1 = require(\"../walletcore\");\n\nconst userSigner_1 = require(\"../walletcore/userSigner\");\n\nconst utils_1 = require(\"./utils\");\n\nfunction loadAndSyncTestWallets(provider) {\n  return __awaiter(this, void 0, void 0, function* () {\n    let wallets = yield loadTestWallets();\n    yield syncTestWallets(wallets, provider);\n    return wallets;\n  });\n}\n\nexports.loadAndSyncTestWallets = loadAndSyncTestWallets;\n\nfunction syncTestWallets(wallets, provider) {\n  return __awaiter(this, void 0, void 0, function* () {\n    yield Promise.all(Object.values(wallets).map(wallet => __awaiter(this, void 0, void 0, function* () {\n      return wallet.sync(provider);\n    })));\n  });\n}\n\nexports.syncTestWallets = syncTestWallets;\n\nfunction loadTestWallets() {\n  return __awaiter(this, void 0, void 0, function* () {\n    let walletNames = [\"alice\", \"bob\", \"carol\", \"dan\", \"eve\", \"frank\", \"grace\", \"heidi\", \"ivan\", \"judy\", \"mallory\", \"mike\"];\n    let wallets = yield Promise.all(walletNames.map(name => __awaiter(this, void 0, void 0, function* () {\n      return yield loadTestWallet(name);\n    })));\n    let walletMap = {};\n\n    for (let i in walletNames) {\n      walletMap[walletNames[i]] = wallets[i];\n    }\n\n    return walletMap;\n  });\n}\n\nexports.loadTestWallets = loadTestWallets;\n\nfunction loadMnemonic() {\n  return __awaiter(this, void 0, void 0, function* () {\n    return yield readTestWalletFileContents(\"mnemonic.txt\");\n  });\n}\n\nexports.loadMnemonic = loadMnemonic;\n\nfunction loadPassword() {\n  return __awaiter(this, void 0, void 0, function* () {\n    return yield readTestWalletFileContents(\"password.txt\");\n  });\n}\n\nexports.loadPassword = loadPassword;\n\nfunction loadTestWallet(name) {\n  return __awaiter(this, void 0, void 0, function* () {\n    let jsonContents = JSON.parse(yield readTestWalletFileContents(name + \".json\"));\n    let pemContents = yield readTestWalletFileContents(name + \".pem\");\n    let pemKey = walletcore_1.UserSecretKey.fromPem(pemContents);\n    return new TestWallet(new address_1.Address(jsonContents.address), pemKey.hex(), jsonContents, pemContents);\n  });\n}\n\nexports.loadTestWallet = loadTestWallet;\n\nfunction readTestWalletFileContents(name) {\n  return __awaiter(this, void 0, void 0, function* () {\n    let filePath = path.join(\"src\", \"testutils\", \"testwallets\", name);\n\n    if (utils_1.isOnBrowserTests()) {\n      return yield downloadTextFile(filePath);\n    }\n\n    return yield fs.promises.readFile(filePath, {\n      encoding: \"utf8\"\n    });\n  });\n}\n\nfunction downloadTextFile(url) {\n  return __awaiter(this, void 0, void 0, function* () {\n    let response = yield axios_1.default.get(url, {\n      responseType: \"text\",\n      transformResponse: []\n    });\n    let text = response.data.toString();\n    return text;\n  });\n}\n\nclass TestWallet {\n  constructor(address, secretKeyHex, keyFileObject, pemFileText) {\n    this.address = address;\n    this.secretKeyHex = secretKeyHex;\n    this.secretKey = Buffer.from(secretKeyHex, \"hex\");\n    this.signer = new userSigner_1.UserSigner(walletcore_1.UserSecretKey.fromString(secretKeyHex));\n    this.keyFileObject = keyFileObject;\n    this.pemFileText = pemFileText;\n    this.account = new account_1.Account(this.address);\n  }\n\n  sync(provider) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this.account.sync(provider);\n      return this;\n    });\n  }\n\n}\n\nexports.TestWallet = TestWallet;","map":{"version":3,"sources":["../../src/testutils/wallets.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TestWallet = exports.loadTestWallet = exports.loadPassword = exports.loadMnemonic = exports.loadTestWallets = exports.syncTestWallets = exports.loadAndSyncTestWallets = void 0;\r\nconst axios_1 = __importDefault(require(\"axios\"));\r\nconst fs = __importStar(require(\"fs\"));\r\nconst path = __importStar(require(\"path\"));\r\nconst account_1 = require(\"../account\");\r\nconst address_1 = require(\"../address\");\r\nconst walletcore_1 = require(\"../walletcore\");\r\nconst userSigner_1 = require(\"../walletcore/userSigner\");\r\nconst utils_1 = require(\"./utils\");\r\nfunction loadAndSyncTestWallets(provider) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        let wallets = yield loadTestWallets();\r\n        yield syncTestWallets(wallets, provider);\r\n        return wallets;\r\n    });\r\n}\r\nexports.loadAndSyncTestWallets = loadAndSyncTestWallets;\r\nfunction syncTestWallets(wallets, provider) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        yield Promise.all(Object.values(wallets).map((wallet) => __awaiter(this, void 0, void 0, function* () { return wallet.sync(provider); })));\r\n    });\r\n}\r\nexports.syncTestWallets = syncTestWallets;\r\nfunction loadTestWallets() {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        let walletNames = [\"alice\", \"bob\", \"carol\", \"dan\", \"eve\", \"frank\", \"grace\", \"heidi\", \"ivan\", \"judy\", \"mallory\", \"mike\"];\r\n        let wallets = yield Promise.all(walletNames.map((name) => __awaiter(this, void 0, void 0, function* () { return yield loadTestWallet(name); })));\r\n        let walletMap = {};\r\n        for (let i in walletNames) {\r\n            walletMap[walletNames[i]] = wallets[i];\r\n        }\r\n        return walletMap;\r\n    });\r\n}\r\nexports.loadTestWallets = loadTestWallets;\r\nfunction loadMnemonic() {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        return yield readTestWalletFileContents(\"mnemonic.txt\");\r\n    });\r\n}\r\nexports.loadMnemonic = loadMnemonic;\r\nfunction loadPassword() {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        return yield readTestWalletFileContents(\"password.txt\");\r\n    });\r\n}\r\nexports.loadPassword = loadPassword;\r\nfunction loadTestWallet(name) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        let jsonContents = JSON.parse(yield readTestWalletFileContents(name + \".json\"));\r\n        let pemContents = yield readTestWalletFileContents(name + \".pem\");\r\n        let pemKey = walletcore_1.UserSecretKey.fromPem(pemContents);\r\n        return new TestWallet(new address_1.Address(jsonContents.address), pemKey.hex(), jsonContents, pemContents);\r\n    });\r\n}\r\nexports.loadTestWallet = loadTestWallet;\r\nfunction readTestWalletFileContents(name) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        let filePath = path.join(\"src\", \"testutils\", \"testwallets\", name);\r\n        if (utils_1.isOnBrowserTests()) {\r\n            return yield downloadTextFile(filePath);\r\n        }\r\n        return yield fs.promises.readFile(filePath, { encoding: \"utf8\" });\r\n    });\r\n}\r\nfunction downloadTextFile(url) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        let response = yield axios_1.default.get(url, { responseType: \"text\", transformResponse: [] });\r\n        let text = response.data.toString();\r\n        return text;\r\n    });\r\n}\r\nclass TestWallet {\r\n    constructor(address, secretKeyHex, keyFileObject, pemFileText) {\r\n        this.address = address;\r\n        this.secretKeyHex = secretKeyHex;\r\n        this.secretKey = Buffer.from(secretKeyHex, \"hex\");\r\n        this.signer = new userSigner_1.UserSigner(walletcore_1.UserSecretKey.fromString(secretKeyHex));\r\n        this.keyFileObject = keyFileObject;\r\n        this.pemFileText = pemFileText;\r\n        this.account = new account_1.Account(this.address);\r\n    }\r\n    sync(provider) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            yield this.account.sync(provider);\r\n            return this;\r\n        });\r\n    }\r\n}\r\nexports.TestWallet = TestWallet;\r\n//# sourceMappingURL=wallets.js.map"]},"metadata":{},"sourceType":"script"}