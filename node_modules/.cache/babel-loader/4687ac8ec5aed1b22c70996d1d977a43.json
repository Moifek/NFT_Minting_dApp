{"ast":null,"code":"import * as env from \"@walletconnect/environment\";\nimport { ENCRYPT_OP, DECRYPT_OP, SIGN_OP, VERIFY_OP, AES_BROWSER_ALGO, AES_LENGTH, HMAC_BROWSER_ALGO, HMAC_BROWSER, HMAC_LENGTH, SHA256_BROWSER_ALGO, SHA512_BROWSER_ALGO, LENGTH_512 } from \"../constants\";\nexport function getAlgo(type) {\n  return type === AES_BROWSER_ALGO ? {\n    length: AES_LENGTH,\n    name: AES_BROWSER_ALGO\n  } : {\n    hash: {\n      name: HMAC_BROWSER_ALGO\n    },\n    name: HMAC_BROWSER\n  };\n}\nexport function getOps(type) {\n  return type === AES_BROWSER_ALGO ? [ENCRYPT_OP, DECRYPT_OP] : [SIGN_OP, VERIFY_OP];\n}\nexport async function browserExportKey(cryptoKey) {\n  let type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : AES_BROWSER_ALGO;\n  const subtle = env.getSubtleCrypto();\n  return new Uint8Array(await subtle.exportKey(\"raw\", cryptoKey));\n}\nexport async function browserImportKey(buffer) {\n  let type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : AES_BROWSER_ALGO;\n  return env.getSubtleCrypto().importKey(\"raw\", buffer, getAlgo(type), true, getOps(type));\n}\nexport async function browserAesEncrypt(iv, key, data) {\n  const subtle = env.getSubtleCrypto();\n  const cryptoKey = await browserImportKey(key, AES_BROWSER_ALGO);\n  const result = await subtle.encrypt({\n    iv,\n    name: AES_BROWSER_ALGO\n  }, cryptoKey, data);\n  return new Uint8Array(result);\n}\nexport async function browserAesDecrypt(iv, key, data) {\n  const subtle = env.getSubtleCrypto();\n  const cryptoKey = await browserImportKey(key, AES_BROWSER_ALGO);\n  const result = await subtle.decrypt({\n    iv,\n    name: AES_BROWSER_ALGO\n  }, cryptoKey, data);\n  return new Uint8Array(result);\n}\nexport async function browserHmacSha256Sign(key, data) {\n  const subtle = env.getSubtleCrypto();\n  const cryptoKey = await browserImportKey(key, HMAC_BROWSER);\n  const signature = await subtle.sign({\n    length: HMAC_LENGTH,\n    name: HMAC_BROWSER\n  }, cryptoKey, data);\n  return new Uint8Array(signature);\n}\nexport async function browserHmacSha512Sign(key, data) {\n  const subtle = env.getSubtleCrypto();\n  const cryptoKey = await browserImportKey(key, HMAC_BROWSER);\n  const signature = await subtle.sign({\n    length: LENGTH_512,\n    name: HMAC_BROWSER\n  }, cryptoKey, data);\n  return new Uint8Array(signature);\n}\nexport async function browserSha256(data) {\n  const subtle = env.getSubtleCrypto();\n  const result = await subtle.digest({\n    name: SHA256_BROWSER_ALGO\n  }, data);\n  return new Uint8Array(result);\n}\nexport async function browserSha512(data) {\n  const subtle = env.getSubtleCrypto();\n  const result = await subtle.digest({\n    name: SHA512_BROWSER_ALGO\n  }, data);\n  return new Uint8Array(result);\n}","map":{"version":3,"sources":["../../../src/lib/browser.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,GAAZ,MAAqB,4BAArB;AACA,SACE,UADF,EAEE,UAFF,EAGE,OAHF,EAIE,SAJF,EAKE,gBALF,EAME,UANF,EAOE,iBAPF,EAQE,YARF,EASE,WATF,EAUE,mBAVF,EAWE,mBAXF,EAYE,UAZF,QAaO,cAbP;AAeA,OAAM,SAAU,OAAV,CAAkB,IAAlB,EAA8B;EAClC,OAAO,IAAI,KAAK,gBAAT,GACH;IAAE,MAAM,EAAE,UAAV;IAAsB,IAAI,EAAE;EAA5B,CADG,GAEH;IACE,IAAI,EAAE;MAAE,IAAI,EAAE;IAAR,CADR;IAEE,IAAI,EAAE;EAFR,CAFJ;AAMD;AAED,OAAM,SAAU,MAAV,CAAiB,IAAjB,EAA6B;EACjC,OAAO,IAAI,KAAK,gBAAT,GACH,CAAC,UAAD,EAAa,UAAb,CADG,GAEH,CAAC,OAAD,EAAU,SAAV,CAFJ;AAGD;AAED,OAAO,eAAe,gBAAf,CACL,SADK,EAE0B;EAAA,IAA/B,IAA+B,uEAAhB,gBAAgB;EAE/B,MAAM,MAAM,GAAG,GAAG,CAAC,eAAJ,EAAf;EACA,OAAO,IAAI,UAAJ,CAAe,MAAM,MAAM,CAAC,SAAP,CAAiB,KAAjB,EAAwB,SAAxB,CAArB,CAAP;AACD;AAED,OAAO,eAAe,gBAAf,CACL,MADK,EAE0B;EAAA,IAA/B,IAA+B,uEAAhB,gBAAgB;EAE/B,OAAQ,GAAG,CAAC,eAAJ,GAA8B,SAA9B,CACN,KADM,EAEN,MAFM,EAGN,OAAO,CAAC,IAAD,CAHD,EAIN,IAJM,EAKN,MAAM,CAAC,IAAD,CALA,CAAR;AAOD;AAED,OAAO,eAAe,iBAAf,CACL,EADK,EAEL,GAFK,EAGL,IAHK,EAGW;EAEhB,MAAM,MAAM,GAAG,GAAG,CAAC,eAAJ,EAAf;EACA,MAAM,SAAS,GAAG,MAAM,gBAAgB,CAAC,GAAD,EAAM,gBAAN,CAAxC;EACA,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC,OAAP,CACnB;IACE,EADF;IAEE,IAAI,EAAE;EAFR,CADmB,EAKnB,SALmB,EAMnB,IANmB,CAArB;EAQA,OAAO,IAAI,UAAJ,CAAe,MAAf,CAAP;AACD;AAED,OAAO,eAAe,iBAAf,CACL,EADK,EAEL,GAFK,EAGL,IAHK,EAGW;EAEhB,MAAM,MAAM,GAAG,GAAG,CAAC,eAAJ,EAAf;EACA,MAAM,SAAS,GAAG,MAAM,gBAAgB,CAAC,GAAD,EAAM,gBAAN,CAAxC;EACA,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC,OAAP,CACnB;IACE,EADF;IAEE,IAAI,EAAE;EAFR,CADmB,EAKnB,SALmB,EAMnB,IANmB,CAArB;EAQA,OAAO,IAAI,UAAJ,CAAe,MAAf,CAAP;AACD;AAED,OAAO,eAAe,qBAAf,CACL,GADK,EAEL,IAFK,EAEW;EAEhB,MAAM,MAAM,GAAG,GAAG,CAAC,eAAJ,EAAf;EACA,MAAM,SAAS,GAAG,MAAM,gBAAgB,CAAC,GAAD,EAAM,YAAN,CAAxC;EACA,MAAM,SAAS,GAAG,MAAM,MAAM,CAAC,IAAP,CACtB;IACE,MAAM,EAAE,WADV;IAEE,IAAI,EAAE;EAFR,CADsB,EAKtB,SALsB,EAMtB,IANsB,CAAxB;EAQA,OAAO,IAAI,UAAJ,CAAe,SAAf,CAAP;AACD;AAED,OAAO,eAAe,qBAAf,CACL,GADK,EAEL,IAFK,EAEW;EAEhB,MAAM,MAAM,GAAG,GAAG,CAAC,eAAJ,EAAf;EACA,MAAM,SAAS,GAAG,MAAM,gBAAgB,CAAC,GAAD,EAAM,YAAN,CAAxC;EACA,MAAM,SAAS,GAAG,MAAM,MAAM,CAAC,IAAP,CACtB;IACE,MAAM,EAAE,UADV;IAEE,IAAI,EAAE;EAFR,CADsB,EAKtB,SALsB,EAMtB,IANsB,CAAxB;EAQA,OAAO,IAAI,UAAJ,CAAe,SAAf,CAAP;AACD;AAED,OAAO,eAAe,aAAf,CAA6B,IAA7B,EAA6C;EAClD,MAAM,MAAM,GAAG,GAAG,CAAC,eAAJ,EAAf;EACA,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC,MAAP,CACnB;IACE,IAAI,EAAE;EADR,CADmB,EAInB,IAJmB,CAArB;EAMA,OAAO,IAAI,UAAJ,CAAe,MAAf,CAAP;AACD;AAED,OAAO,eAAe,aAAf,CAA6B,IAA7B,EAA6C;EAClD,MAAM,MAAM,GAAG,GAAG,CAAC,eAAJ,EAAf;EACA,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC,MAAP,CACnB;IACE,IAAI,EAAE;EADR,CADmB,EAInB,IAJmB,CAArB;EAMA,OAAO,IAAI,UAAJ,CAAe,MAAf,CAAP;AACD","sourceRoot":"","sourcesContent":["import * as env from \"@walletconnect/environment\";\r\nimport { ENCRYPT_OP, DECRYPT_OP, SIGN_OP, VERIFY_OP, AES_BROWSER_ALGO, AES_LENGTH, HMAC_BROWSER_ALGO, HMAC_BROWSER, HMAC_LENGTH, SHA256_BROWSER_ALGO, SHA512_BROWSER_ALGO, LENGTH_512, } from \"../constants\";\r\nexport function getAlgo(type) {\r\n    return type === AES_BROWSER_ALGO\r\n        ? { length: AES_LENGTH, name: AES_BROWSER_ALGO }\r\n        : {\r\n            hash: { name: HMAC_BROWSER_ALGO },\r\n            name: HMAC_BROWSER,\r\n        };\r\n}\r\nexport function getOps(type) {\r\n    return type === AES_BROWSER_ALGO\r\n        ? [ENCRYPT_OP, DECRYPT_OP]\r\n        : [SIGN_OP, VERIFY_OP];\r\n}\r\nexport async function browserExportKey(cryptoKey, type = AES_BROWSER_ALGO) {\r\n    const subtle = env.getSubtleCrypto();\r\n    return new Uint8Array(await subtle.exportKey(\"raw\", cryptoKey));\r\n}\r\nexport async function browserImportKey(buffer, type = AES_BROWSER_ALGO) {\r\n    return env.getSubtleCrypto().importKey(\"raw\", buffer, getAlgo(type), true, getOps(type));\r\n}\r\nexport async function browserAesEncrypt(iv, key, data) {\r\n    const subtle = env.getSubtleCrypto();\r\n    const cryptoKey = await browserImportKey(key, AES_BROWSER_ALGO);\r\n    const result = await subtle.encrypt({\r\n        iv,\r\n        name: AES_BROWSER_ALGO,\r\n    }, cryptoKey, data);\r\n    return new Uint8Array(result);\r\n}\r\nexport async function browserAesDecrypt(iv, key, data) {\r\n    const subtle = env.getSubtleCrypto();\r\n    const cryptoKey = await browserImportKey(key, AES_BROWSER_ALGO);\r\n    const result = await subtle.decrypt({\r\n        iv,\r\n        name: AES_BROWSER_ALGO,\r\n    }, cryptoKey, data);\r\n    return new Uint8Array(result);\r\n}\r\nexport async function browserHmacSha256Sign(key, data) {\r\n    const subtle = env.getSubtleCrypto();\r\n    const cryptoKey = await browserImportKey(key, HMAC_BROWSER);\r\n    const signature = await subtle.sign({\r\n        length: HMAC_LENGTH,\r\n        name: HMAC_BROWSER,\r\n    }, cryptoKey, data);\r\n    return new Uint8Array(signature);\r\n}\r\nexport async function browserHmacSha512Sign(key, data) {\r\n    const subtle = env.getSubtleCrypto();\r\n    const cryptoKey = await browserImportKey(key, HMAC_BROWSER);\r\n    const signature = await subtle.sign({\r\n        length: LENGTH_512,\r\n        name: HMAC_BROWSER,\r\n    }, cryptoKey, data);\r\n    return new Uint8Array(signature);\r\n}\r\nexport async function browserSha256(data) {\r\n    const subtle = env.getSubtleCrypto();\r\n    const result = await subtle.digest({\r\n        name: SHA256_BROWSER_ALGO,\r\n    }, data);\r\n    return new Uint8Array(result);\r\n}\r\nexport async function browserSha512(data) {\r\n    const subtle = env.getSubtleCrypto();\r\n    const result = await subtle.digest({\r\n        name: SHA512_BROWSER_ALGO,\r\n    }, data);\r\n    return new Uint8Array(result);\r\n}\r\n//# sourceMappingURL=browser.js.map"]},"metadata":{},"sourceType":"module"}